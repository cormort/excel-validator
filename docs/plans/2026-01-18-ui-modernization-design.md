# Excel 驗證工具 UI 現代化設計文檔

**日期**: 2026-01-18  
**項目**: SumCheck - Excel 數值驗算工具  
**目標**: 全面 UI 現代化，提升用戶體驗和工作效率

---

## 架構設計

### 三層架構

**核心邏輯層**

- 保留現有的 `Validator`、`ExcelParser`、`SmartDetect` 模組
- 添加性能監控和進度回調接口
- 無需重寫已驗證的邏輯

**UI框架層**

- 使用輕量級 Web Components 或 Preact
- 主要組件：
  - 拖放上傳區域（帶進度指示）
  - 智能模式選擇器（視覺化卡片預覽）
  - 互動式配置面板（實時表格預覽）
  - 結果展示器（高亮錯誤的表格視圖）

**狀態管理層**

- 簡單的 reactive 狀態管理器
- 數據變化自動更新 UI
- 取代手動 DOM 操作

### 優點

- 最小化核心邏輯修改
- 現代化開發體驗
- 易於測試和維護

---

## UI/UX 增強設計

### 視覺現代化

- 漸層色彩、圓角卡片、微動畫
- 按鈕漸層背景和陰影效果
- 點擊縮放反饋
- 專業藍綠色系，深色模式自動調整對比度
- CSS 變量過渡，動畫流暢且可禁用（無障礙性）

### 拖放體驗

- 大型互動上傳區域
- 拖入時視覺反饋（邊框高亮、背景色變化）
- 多檔案同時拖放，自動識別合併
- 進度條和檔案信息顯示

### 智能流程簡化

- 檔案上傳後自動運行智能偵測
- 後台分析表格結構
- 顯示可滾動、可縮放的表格預覽
- 自動推薦最適合的驗算模式並高亮
- "一鍵驗算"按鈕跳過手動配置

### 即時反饋

- 操作即時反饋（按鈕狀態、配置變更）
- Toast 通知而非 alert
- 錯誤訊息顏色編碼（紅色=錯誤、黃色=警告）
- 具體解決建議

---

## 可視化增強和工作流程優化

### 錯誤可視化

- 渲染原始 Excel 表格，高亮錯誤單元格
- 紅色邊框、背景漸層標記錯誤
- 點擊錯誤彈出詳情卡片：
  - 預期值 vs 實際值
  - 錯誤類型（加總錯誤、遺漏項目等）
  - 建議修正動作
  - 相關單元格連結

### 表格預覽和編輯

- 點選列/行設定範圍，無需輸入行列號
- 縮放、凍結標題行、篩選列
- 高亮當前選中的驗算範圍

### 工作流程增強

- 自動保存配置到 localStorage
- 顯示最近的驗算記錄，快速重新運行
- 多種導出選項（Excel、CSV、PDF、HTML）
- 鍵盤快捷鍵（Ctrl+U 上傳、Ctrl+V 驗算、Ctrl+S 保存）

---

## 響應式設計

### 斷點設計

**手機版（<768px）**

- 隱藏複雜配置面板
- 底部抽屜菜單
- 表格預覽改為卡片視圖
- 橫向滾動查看

**平板版（768-1024px）**

- 側邊欄和主內容並排
- 模式卡片 2 列網格

**桌面版（>1024px）**

- 完整佈局，所有面板同時可見
- 模式卡片 3 列網格

### 技術實現

- CSS Grid 和 Flexbox 流體佈局
- `@media` 查詢實現斷點
- SVG 圖標替代 emoji
- 跨平台一致性

---

## 實施計劃

### 第一階段（1-2週）

- 重構 UI Controller
- 引入狀態管理
- 更新 CSS 為響應式

### 第二階段（1-2週）

- 實現拖放上傳改進
- 智能流程簡化

### 第三階段（1-2週）

- 開發錯誤可視化組件
- 表格預覽組件

### 第四階段（1-2週）

- 工作流程增強
- 歷史記錄、自動保存、導出功能

### 第五階段（1-2週）

- 性能優化
- 最終測試和修復

**總體時間**: 5-10 週

---

## 技術棧建議

- UI 框架: Preact（輕量級、生態成熟）
- 狀態管理: 原生 reactive 模式或 Zustand
- 圖標: Lucide Icons（SVG，一致性好）
- 動畫: Framer Motion 或 CSS 過渡
- 構建: Vite（快速開發體驗）
- 測試: Vitest（單元測試）+ Playwright（E2E）

---

## 成功標準

- 大檔案（>10MB）載入時間 < 5 秒
- 錯誤識別準確率 > 95%
- 用戶完成驗算步驟減少 40%
- 移動端完全可用
- 無障礙性符合 WCAG 2.1 AA 標準
